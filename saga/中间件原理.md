![image-20200421234322272](C:\Users\Artificial\AppData\Roaming\Typora\typora-user-images\image-20200421234322272.png)



action被中间件拦截



调用next方法调用下一个中间件



没有的话把action转发个reducer



什么是中间件,位于action和reducer之间的函数

负责转发action或者做一些其他的异步操作之类的





没有中间件的时候,action直接被发送给reducer,

有了中间件,可以拦截并且封装action的值,比如把json封装进去





![image-20200421235528904](C:\Users\Artificial\AppData\Roaming\Typora\typora-user-images\image-20200421235528904.png)



第一个,全局store

第二个,next方法

第三个,action



applymiddle注册中间件

koa是use



中间件修改默认值

![image-20200422000047358](C:\Users\Artificial\AppData\Roaming\Typora\typora-user-images\image-20200422000047358.png)

![image-20200421235922670](C:\Users\Artificial\AppData\Roaming\Typora\typora-user-images\image-20200421235922670.png)

比reducer当中的里面的默认state优先级高

![image-20200422000137190](C:\Users\Artificial\AppData\Roaming\Typora\typora-user-images\image-20200422000137190.png)





手写一个中间件

![image-20200422000457914](C:\Users\Artificial\AppData\Roaming\Typora\typora-user-images\image-20200422000457914.png)

![image-20200422000518985](C:\Users\Artificial\AppData\Roaming\Typora\typora-user-images\image-20200422000518985.png)

返回值就是action

![image-20200422000328577](C:\Users\Artificial\AppData\Roaming\Typora\typora-user-images\image-20200422000328577.png)